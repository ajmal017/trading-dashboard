{"ast":null,"code":"import _classCallCheck from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/createClass\";\nvar Config = {\n  PROTOCOL: \"ws:\",\n  HOST: \"//localhost\",\n  PORT: \":7888\"\n};\n\nvar Socket =\n/*#__PURE__*/\nfunction () {\n  function Socket() {\n    var _this = this;\n\n    _classCallCheck(this, Socket);\n\n    this.opened = false;\n    this.callbacks = {};\n    var address = Config.PROTOCOL + Config.HOST + Config.PORT;\n    console.log(\"Created a WebSocket connecting to: \" + address);\n    this.socket = new WebSocket(address);\n\n    this.socket.onopen = function () {\n      _this.opened = true; // TODO subscribe for all pending subjects\n    };\n\n    this.socket.onmessage = function (msg) {\n      console.log(\"SOCKET: \" + msg.data); // TODO trigger callback conditionally\n\n      var subject = msg.data.substring(msg.data.indexOf(\":\") + 1);\n\n      _this.callbacks[subject]();\n    };\n  }\n\n  _createClass(Socket, [{\n    key: \"subscribeForPushNotifications\",\n    value: function subscribeForPushNotifications(subscriptionSubject, callback) {\n      if (this.opened) {\n        var msg = JSON.stringify({\n          type: \"SUBSCRIBE\",\n          subject: subscriptionSubject\n        });\n        this.socket.send(msg);\n      }\n\n      this.callbacks[subscriptionSubject] = callback;\n    }\n  }]);\n\n  return Socket;\n}();\n\nexport default Socket;","map":{"version":3,"sources":["/home/dmitry/React/dashboard/src/socket/Socket.js"],"names":["Config","PROTOCOL","HOST","PORT","Socket","opened","callbacks","address","console","log","socket","WebSocket","onopen","onmessage","msg","data","subject","substring","indexOf","subscriptionSubject","callback","JSON","stringify","type","send"],"mappings":";;AAAA,IAAMA,MAAM,GAAG;AACbC,EAAAA,QAAQ,EAAE,KADG;AAEbC,EAAAA,IAAI,EAAE,aAFO;AAGbC,EAAAA,IAAI,EAAE;AAHO,CAAf;;IAMMC,M;;;AAMJ,oBAAc;AAAA;;AAAA;;AAAA,SAHdC,MAGc,GAHL,KAGK;AAAA,SAFdC,SAEc,GAFF,EAEE;AACZ,QAAMC,OAAO,GAAGP,MAAM,CAACC,QAAP,GAAkBD,MAAM,CAACE,IAAzB,GAAgCF,MAAM,CAACG,IAAvD;AACAK,IAAAA,OAAO,CAACC,GAAR,CAAY,wCAAwCF,OAApD;AACA,SAAKG,MAAL,GAAc,IAAIC,SAAJ,CAAcJ,OAAd,CAAd;;AAEA,SAAKG,MAAL,CAAYE,MAAZ,GAAqB,YAAM;AACzB,MAAA,KAAI,CAACP,MAAL,GAAc,IAAd,CADyB,CAEzB;AACD,KAHD;;AAKA,SAAKK,MAAL,CAAYG,SAAZ,GAAwB,UAACC,GAAD,EAAS;AAC/BN,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAaK,GAAG,CAACC,IAA7B,EAD+B,CAE/B;;AACA,UAAIC,OAAO,GAAGF,GAAG,CAACC,IAAJ,CAASE,SAAT,CAAmBH,GAAG,CAACC,IAAJ,CAASG,OAAT,CAAiB,GAAjB,IAAwB,CAA3C,CAAd;;AACA,MAAA,KAAI,CAACZ,SAAL,CAAeU,OAAf;AACD,KALD;AAMD;;;;kDAE6BG,mB,EAAqBC,Q,EAAU;AAE3D,UAAI,KAAKf,MAAT,EAAiB;AACf,YAAMS,GAAG,GAAGO,IAAI,CAACC,SAAL,CAAe;AAACC,UAAAA,IAAI,EAAC,WAAN;AAAmBP,UAAAA,OAAO,EAACG;AAA3B,SAAf,CAAZ;AACA,aAAKT,MAAL,CAAYc,IAAZ,CAAiBV,GAAjB;AACD;;AAED,WAAKR,SAAL,CAAea,mBAAf,IAAsCC,QAAtC;AACD;;;;;;AAIH,eAAehB,MAAf","sourcesContent":["const Config = {\n  PROTOCOL: \"ws:\",\n  HOST: \"//localhost\",\n  PORT: \":7888\"\n}\n\nclass Socket {\n\n  socket\n  opened = false\n  callbacks = {}\n\n  constructor() {\n    const address = Config.PROTOCOL + Config.HOST + Config.PORT\n    console.log(\"Created a WebSocket connecting to: \" + address)\n    this.socket = new WebSocket(address)\n\n    this.socket.onopen = () => {\n      this.opened = true\n      // TODO subscribe for all pending subjects\n    }\n\n    this.socket.onmessage = (msg) => {\n      console.log(\"SOCKET: \" + msg.data)\n      // TODO trigger callback conditionally\n      let subject = msg.data.substring(msg.data.indexOf(\":\") + 1)\n      this.callbacks[subject]()\n    }\n  }\n\n  subscribeForPushNotifications(subscriptionSubject, callback) {\n\n    if (this.opened) {\n      const msg = JSON.stringify({type:\"SUBSCRIBE\", subject:subscriptionSubject})\n      this.socket.send(msg)\n    }\n\n    this.callbacks[subscriptionSubject] = callback\n  }\n\n}\n\nexport default Socket;\n"]},"metadata":{},"sourceType":"module"}
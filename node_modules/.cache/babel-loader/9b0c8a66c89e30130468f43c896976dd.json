{"ast":null,"code":"import _classCallCheck from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/dmitry/React/dashboard/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/dmitry/React/dashboard/src/App.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport './App.css';\nimport Order from './components/Order';\nimport Trade from './components/Trade';\nimport TextInput from './components/TextInput';\nimport InstrumentSelector from './components/InstrumentSelector';\nimport SideSelector from './components/SideSelector';\nimport ServerManager from './components/ServerManager';\nimport PriceChart from './components/PriceChart';\nimport Socket from './socket/Socket';\nvar serverHostName = new ServerManager().getServerHostname();\ndocument.title = \"Trading Dashboard\";\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this));\n    _this.state = {\n      orders: [],\n      trades: [],\n      tradePrices: [],\n      ord_props: {}\n    };\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"subscribeForPushNotifications\",\n    value: function subscribeForPushNotifications() {\n      var _this2 = this;\n\n      var socket = Socket.getInstance();\n\n      socket.onopen = function () {\n        console.log(\"SOCKET: Socket has connected now\");\n        var msg = JSON.stringify({\n          type: \"SUBSCRIBE\",\n          subject: \"ORDERS\"\n        });\n        console.log(\"SOCKET: sending msg: \" + msg);\n        socket.send(msg);\n      };\n\n      socket.onmessage = function (msg) {\n        console.log(\"SOCKET: New message from the server: \" + msg.data);\n\n        _this2.refreshData();\n      };\n    }\n  }, {\n    key: \"onNewOrderUpdate\",\n    value: function onNewOrderUpdate(key, value) {\n      console.log('onNewOrderUpdate: key: ' + key + ' , value: ' + value);\n      var ord_p = this.state.ord_props;\n      ord_p[key] = value;\n      this.setState({\n        ord_props: ord_p\n      });\n\n      if (key === 'instcode') {\n        this.getTradesByInstrument(this.state.ord_props.instcode);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.refreshData();\n    }\n  }, {\n    key: \"refreshData\",\n    value: function refreshData() {\n      this.getOrders();\n      this.getTrades();\n      this.getTradesByInstrument(this.state.ord_props.instcode);\n    }\n  }, {\n    key: \"getOrders\",\n    value: function getOrders() {\n      var _this3 = this;\n\n      axios.get(serverHostName + \"/order\").then(function (res) {\n        console.log(res.data);\n        console.log(res.data.length);\n        var order_list = res.data;\n\n        if (typeof order_list != 'string') {\n          _this3.setState({\n            orders: order_list.reverse()\n          });\n        }\n      });\n    }\n  }, {\n    key: \"getTrades\",\n    value: function getTrades() {\n      var _this4 = this;\n\n      axios.get(serverHostName + \"/trade\").then(function (res) {\n        console.log(res.data);\n        console.log(res.data.length);\n        var trade_list = res.data;\n        console.log(trade_list);\n        console.log(trade_list.length);\n        console.log(typeof trade_list);\n\n        if (typeof trade_list != 'string') {\n          _this4.setState({\n            trades: trade_list.reverse()\n          });\n        }\n      });\n    }\n  }, {\n    key: \"getTradesByInstrument\",\n    value: function getTradesByInstrument(instrCode) {\n      var _this5 = this;\n\n      axios.get(serverHostName + \"/trade/byInstr?instCode=\" + instrCode).then(function (res) {\n        console.log(res.data);\n        console.log(res.data.length);\n        var trade_list = res.data;\n\n        _this5.setState({\n          tradePrices: trade_list\n        });\n      });\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick() {\n      var _this6 = this;\n\n      axios.post(serverHostName + '/order/add', {\n        \"InstrCode\": this.state.ord_props.instcode,\n        \"Quantity\": this.state.ord_props.quantity,\n        \"Price\": this.state.ord_props.price,\n        \"Notes\": this.state.ord_props.notes,\n        \"Side\": this.state.ord_props.side\n      }).then(function (response) {\n        console.log(response);\n\n        _this6.refreshData();\n      }, function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this7 = this;\n\n      var selectedTrades = [];\n\n      if (this.state.tradePrices.length > 0) {\n        selectedTrades = this.state.tradePrices.map(function (trade) {\n          return {\n            \"timestamp\": trade.Timestamp,\n            \"price\": trade.Price\n          };\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"MainBlock\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"FloatLeft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"OrderEntry\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"Title\",\n        id: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, \"Order entry\"), React.createElement(InstrumentSelector, {\n        onInputUpdate: function onInputUpdate(key, value) {\n          return _this7.onNewOrderUpdate(key, value);\n        },\n        tag: \"instcode\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }), React.createElement(SideSelector, {\n        onInputUpdate: function onInputUpdate(key, value) {\n          return _this7.onNewOrderUpdate(key, value);\n        },\n        tag: \"side\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }), React.createElement(TextInput, {\n        onInputUpdate: function onInputUpdate(key, value) {\n          return _this7.onNewOrderUpdate(key, value);\n        },\n        input_name: \"Quantity\",\n        tag: \"quantity\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }), React.createElement(TextInput, {\n        onInputUpdate: function onInputUpdate(key, value) {\n          return _this7.onNewOrderUpdate(key, value);\n        },\n        input_name: \"Price\",\n        tag: \"price\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }), React.createElement(TextInput, {\n        onInputUpdate: function onInputUpdate(key, value) {\n          return _this7.onNewOrderUpdate(key, value);\n        },\n        input_name: \"Notes\",\n        tag: \"notes\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"Button\",\n        id: \"btn_send_order\",\n        onClick: this.handleClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, \"Send order\"))), React.createElement(\"div\", {\n        className: \"FloatLeft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"Title\",\n        id: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, \"Trade prices\"), React.createElement(PriceChart, {\n        instrumentCode: this.state.ord_props.instcode,\n        data: selectedTrades,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }))), React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"MainBlock\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"FloatLeft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"Title\",\n        id: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"Orders\"), React.createElement(\"table\", {\n        className: \"DataTable\",\n        id: \"orders\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"Order ID\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, \"Timestamp\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"Inst\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"Side\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"Qty\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, \"Price\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, \"Filled Quantity\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, \"Fill Price\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, \"Status\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, \"Notes\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, \"Action\")), this.state.orders.map(function (order) {\n        return React.createElement(Order, {\n          orderid: order.OrderID,\n          timestamp: order.Timestamp,\n          instrument: order.InstrCode,\n          side: order.Side,\n          quantity: order.Quantity,\n          price: order.Price,\n          quantity_filled: order.QuantityFilled,\n          fill_price: order.FillPrice,\n          status: order.Status,\n          notes: order.Notes,\n          updateView: _this7.refreshData.bind(_this7),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168\n          },\n          __self: this\n        });\n      }))), React.createElement(\"div\", {\n        className: \"FloatLeft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"Title\",\n        id: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, \"Trades\"), React.createElement(\"table\", {\n        className: \"DataTable\",\n        id: \"trades\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, \"Trade ID\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, \"Timestamp\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, \"Resting order ID\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, \"Incoming order ID\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \"Qty\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"Price\")), this.state.trades.map(function (trade) {\n        return React.createElement(Trade, {\n          tradeid: trade.TradeID,\n          timestamp: trade.Timestamp,\n          restingorderid: trade.RestingOrderID,\n          incomingorderid: trade.IncomingOrderID,\n          quantity: trade.Quantity,\n          price: trade.Price,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        });\n      }))))));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/home/dmitry/React/dashboard/src/App.js"],"names":["React","Component","axios","Order","Trade","TextInput","InstrumentSelector","SideSelector","ServerManager","PriceChart","Socket","serverHostName","getServerHostname","document","title","App","state","orders","trades","tradePrices","ord_props","handleClick","bind","socket","getInstance","onopen","console","log","msg","JSON","stringify","type","subject","send","onmessage","data","refreshData","key","value","ord_p","setState","getTradesByInstrument","instcode","getOrders","getTrades","get","then","res","length","order_list","reverse","trade_list","instrCode","post","quantity","price","notes","side","response","error","selectedTrades","map","trade","Timestamp","Price","onNewOrderUpdate","order","OrderID","InstrCode","Side","Quantity","QuantityFilled","FillPrice","Status","Notes","TradeID","RestingOrderID","IncomingOrderID"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport './App.css';\nimport Order from './components/Order'\nimport Trade from './components/Trade'\nimport TextInput from './components/TextInput'\nimport InstrumentSelector from './components/InstrumentSelector'\nimport SideSelector from './components/SideSelector'\nimport ServerManager from './components/ServerManager'\nimport PriceChart from './components/PriceChart'\nimport Socket from './socket/Socket'\n\nconst serverHostName = new ServerManager ().getServerHostname();\n\ndocument.title = \"Trading Dashboard\";\n\nclass App extends React.Component {\n\n  constructor() {\n    super()\n\n    this.handleClick = this.handleClick.bind(this)\n\n  }\n\n  subscribeForPushNotifications() {\n    const socket = Socket.getInstance();\n    socket.onopen = () => {\n      console.log(\"SOCKET: Socket has connected now\")\n      const msg = JSON.stringify({type:\"SUBSCRIBE\", subject:\"ORDERS\"})\n      console.log(\"SOCKET: sending msg: \" + msg)\n      socket.send(msg);\n    }\n    socket.onmessage = (msg) => {\n      console.log(\"SOCKET: New message from the server: \" + msg.data)\n      this.refreshData()\n    }\n  }\n\n  state = {\n    orders: [],\n    trades: [],\n    tradePrices: [],\n    ord_props: {}\n  }\n\n  onNewOrderUpdate(key, value) {\n    console.log('onNewOrderUpdate: key: ' + key + ' , value: ' + value)\n    var ord_p = this.state.ord_props\n    ord_p[key] = value\n    this.setState({ ord_props: ord_p })\n    if (key === 'instcode') {\n      this.getTradesByInstrument(this.state.ord_props.instcode)\n    }\n  }\n\n  componentDidMount() {\n    this.refreshData();\n  }\n\n  refreshData() {\n    this.getOrders()\n    this.getTrades()\n    this.getTradesByInstrument(this.state.ord_props.instcode)\n  }\n\n  getOrders() {\n    axios.get(serverHostName + `/order`)\n      .then(res => {\n        console.log(res.data);\n        console.log(res.data.length);\n        const order_list = res.data;\n        if (typeof(order_list) != 'string') {\n          this.setState({ orders: order_list.reverse() });\n        }\n      });\n  }\n\n  getTrades() {\n    axios.get(serverHostName + `/trade`)\n      .then(res => {\n        console.log(res.data);\n        console.log(res.data.length);\n        const trade_list = res.data;\n        console.log(trade_list);\n        console.log(trade_list.length);\n        console.log(typeof(trade_list));\n        if (typeof(trade_list) != 'string') {\n          this.setState({ trades: trade_list.reverse() });\n        }\n      });\n  }\n\n  getTradesByInstrument(instrCode) {\n    axios.get(serverHostName + `/trade/byInstr?instCode=` + instrCode)\n      .then(res => {\n        console.log(res.data);\n        console.log(res.data.length);\n        const trade_list = res.data;\n        this.setState({ tradePrices: trade_list });\n      });\n  }\n\n  handleClick() {\n    axios.post(serverHostName + '/order/add', {\n      \"InstrCode\": this.state.ord_props.instcode,\n      \"Quantity\": this.state.ord_props.quantity,\n      \"Price\": this.state.ord_props.price,\n      \"Notes\": this.state.ord_props.notes,\n      \"Side\": this.state.ord_props.side,\n\t})\n\t.then(\n\t\t(response) => { console.log(response); this.refreshData() },\n\t\t(error) => { console.log(error) }\n\t);\n  }\n\n  render() {\n\n    var selectedTrades = []\n    if (this.state.tradePrices.length > 0) {\n      selectedTrades = this.state.tradePrices.map(trade => { return {\"timestamp\": trade.Timestamp, \"price\": trade.Price}});\n    }\n\n    return (\n      <div>\n        <div className=\"MainBlock\">\n        <div className=\"FloatLeft\">\n        <div className=\"OrderEntry\">\n          <h1 className=\"Title\" id=\"title\">Order entry</h1>\n          <InstrumentSelector\n             onInputUpdate={(key, value) => this.onNewOrderUpdate(key, value)} tag=\"instcode\"/>\n          <SideSelector\n             onInputUpdate={(key, value) => this.onNewOrderUpdate(key, value)} tag=\"side\"/>\n          <TextInput\n             onInputUpdate={(key, value) => this.onNewOrderUpdate(key, value)} input_name=\"Quantity\" tag=\"quantity\"/>\n          <TextInput\n             onInputUpdate={(key, value) => this.onNewOrderUpdate(key, value)} input_name=\"Price\" tag=\"price\"/>\n          <TextInput\n             onInputUpdate={(key, value) => this.onNewOrderUpdate(key, value)} input_name=\"Notes\" tag=\"notes\"/>\n          <button className=\"Button\" id=\"btn_send_order\" onClick={this.handleClick}>Send order</button>\n        </div>\n\t    </div>\n        <div className=\"FloatLeft\">\n          <h1 className= \"Title\" id=\"title\">Trade prices</h1>\n          <PriceChart instrumentCode={this.state.ord_props.instcode} data={selectedTrades}/>\n        </div>\n        </div>\n        <ul>\n        <div className=\"MainBlock\">\n            <div className=\"FloatLeft\">\n            <h1 className= \"Title\" id=\"title\">Orders</h1>\n            <table className=\"DataTable\" id=\"orders\">\n              <tr>\n                <th>Order ID</th>\n                <th>Timestamp</th>\n                <th>Inst</th>\n                <th>Side</th>\n                <th>Qty</th>\n                <th>Price</th>\n                <th>Filled Quantity</th>\n                <th>Fill Price</th>\n                <th>Status</th>\n                <th>Notes</th>\n                <th>Action</th>\n              </tr>\n              {this.state.orders.map(order =>\n                <Order orderid={order.OrderID} timestamp={order.Timestamp} instrument={order.InstrCode} side={order.Side} quantity={order.Quantity} price={order.Price} quantity_filled={order.QuantityFilled} fill_price={order.FillPrice} status={order.Status} notes={order.Notes} updateView={this.refreshData.bind(this)} />\n              )}\n            </table>\n            </div>\n            <div className=\"FloatLeft\">\n            <h1 className=\"Title\" id=\"title\">Trades</h1>\n            <table className=\"DataTable\" id=\"trades\">\n              <tr>\n                <th>Trade ID</th>\n                <th>Timestamp</th>\n                <th>Resting order ID</th>\n                <th>Incoming order ID</th>\n                <th>Qty</th>\n                <th>Price</th>\n              </tr>\n              {this.state.trades.map(trade =>\n                <Trade tradeid={trade.TradeID} timestamp={trade.Timestamp} restingorderid={trade.RestingOrderID} incomingorderid={trade.IncomingOrderID} quantity={trade.Quantity} price={trade.Price} />\n              )}\n            </table>\n            </div>\n        </div>\n        </ul>\n      </div>\n    );\n  }\n\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}